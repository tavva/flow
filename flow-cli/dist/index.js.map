{
  "version": 3,
  "sources": ["../src/index.ts", "../src/config.ts", "../src/plugin-settings.ts", "../src/capture.ts"],
  "sourcesContent": ["// ABOUTME: CLI entry point for Flow quick capture\n// ABOUTME: Orchestrates config reading, plugin settings, and file capture\n\nimport { readConfig, writeConfig, getConfigPath, promptForVaultPath } from \"./config\";\nimport { readPluginSettings } from \"./plugin-settings\";\nimport { capture } from \"./capture\";\n\ninterface ParsedArgs {\n  text?: string;\n  vault?: string;\n  config: boolean;\n}\n\nexport function parseArgs(args: string[]): ParsedArgs {\n  const result: ParsedArgs = {\n    config: false,\n  };\n\n  for (let i = 0; i < args.length; i++) {\n    if (args[i] === \"--vault\" && i + 1 < args.length) {\n      result.vault = args[i + 1];\n      i++; // Skip next arg\n    } else if (args[i] === \"--config\") {\n      result.config = true;\n    } else if (!result.text) {\n      result.text = args[i];\n    }\n  }\n\n  if (!result.text && !result.config) {\n    throw new Error(\"Please provide text to capture\");\n  }\n\n  return result;\n}\n\nexport async function main(): Promise<void> {\n  try {\n    const args = parseArgs(process.argv.slice(2));\n\n    // Handle --config flag\n    if (args.config) {\n      const vaultPath = await promptForVaultPath();\n      writeConfig({ defaultVault: vaultPath });\n      console.log(`Saved default vault to ${getConfigPath()}`);\n      if (!args.text) {\n        return;\n      }\n    }\n\n    // Determine vault path\n    let vaultPath = args.vault;\n    if (!vaultPath) {\n      const config = readConfig();\n      if (!config) {\n        console.error(\"No default vault configured.\");\n        const newVaultPath = await promptForVaultPath();\n        console.error(`Saving default vault to ${getConfigPath()}`);\n        writeConfig({ defaultVault: newVaultPath });\n        vaultPath = newVaultPath;\n      } else {\n        vaultPath = config.defaultVault;\n      }\n    }\n\n    // Read plugin settings\n    const settings = readPluginSettings(vaultPath);\n\n    // Capture text\n    if (args.text) {\n      capture(vaultPath, settings.cliInboxFile, args.text);\n      console.log(`Captured: \"${args.text}\"`);\n    }\n  } catch (error) {\n    if (error instanceof Error) {\n      console.error(`Error: ${error.message}`);\n    } else {\n      console.error(\"An unknown error occurred\");\n    }\n    process.exit(1);\n  }\n}\n\n// Run if executed directly\nif (require.main === module) {\n  main();\n}\n", "// ABOUTME: CLI configuration file management\n// ABOUTME: Handles reading and writing vault path to ~/.config/flow-cli/config.json\n\nimport * as fs from \"fs\";\nimport * as path from \"path\";\nimport * as os from \"os\";\nimport * as readline from \"readline\";\nimport { Config } from \"./types\";\n\nexport function getConfigPath(): string {\n  return path.join(os.homedir(), \".config\", \"flow-cli\", \"config.json\");\n}\n\nexport function readConfig(configPath?: string): Config | null {\n  const filePath = configPath || getConfigPath();\n\n  if (!fs.existsSync(filePath)) {\n    return null;\n  }\n\n  try {\n    const content = fs.readFileSync(filePath, \"utf-8\");\n    return JSON.parse(content) as Config;\n  } catch {\n    return null;\n  }\n}\n\nexport function writeConfig(config: Config, configPath?: string): void {\n  const filePath = configPath || getConfigPath();\n  const dir = path.dirname(filePath);\n\n  if (!fs.existsSync(dir)) {\n    fs.mkdirSync(dir, { recursive: true });\n  }\n\n  fs.writeFileSync(filePath, JSON.stringify(config, null, 2));\n}\n\nexport async function promptForVaultPath(): Promise<string> {\n  const rl = readline.createInterface({\n    input: process.stdin,\n    output: process.stdout,\n  });\n\n  return new Promise((resolve) => {\n    rl.question(\"Enter vault path: \", (answer) => {\n      rl.close();\n      resolve(answer.trim());\n    });\n  });\n}\n", "// ABOUTME: Reads Flow plugin settings from Obsidian vault\n// ABOUTME: Validates vault structure and extracts cliInboxFile setting\n\nimport * as fs from \"fs\";\nimport * as path from \"path\";\nimport { PluginSettings } from \"./types\";\n\nexport function readPluginSettings(vaultPath: string): PluginSettings {\n  // Expand ~ to home directory\n  const expandedPath = vaultPath.replace(/^~/, process.env.HOME || \"\");\n\n  if (!fs.existsSync(expandedPath)) {\n    throw new Error(`Vault not found at ${expandedPath}`);\n  }\n\n  const obsidianDir = path.join(expandedPath, \".obsidian\");\n  if (!fs.existsSync(obsidianDir)) {\n    throw new Error(`Not a valid Obsidian vault (missing .obsidian folder): ${expandedPath}`);\n  }\n\n  const pluginDir = path.join(obsidianDir, \"plugins\", \"flow\");\n  if (!fs.existsSync(pluginDir)) {\n    throw new Error(`Flow plugin not installed at ${pluginDir}`);\n  }\n\n  const settingsFile = path.join(pluginDir, \"data.json\");\n  try {\n    const content = fs.readFileSync(settingsFile, \"utf-8\");\n    const settings = JSON.parse(content) as PluginSettings;\n\n    if (!settings.cliInboxFile) {\n      throw new Error(\n        \"cliInboxFile not configured in Flow plugin settings\\n\" +\n          \"Please open Obsidian and configure: Settings \u2192 Flow GTD Coach \u2192 CLI Inbox File\"\n      );\n    }\n\n    return settings;\n  } catch (error) {\n    if (error instanceof Error && error.message.includes(\"cliInboxFile\")) {\n      throw error;\n    }\n    throw new Error(\"Could not read Flow plugin settings\");\n  }\n}\n", "// ABOUTME: Appends captured text to inbox file\n// ABOUTME: Creates file and parent directories if needed\n\nimport * as fs from \"fs\";\nimport * as path from \"path\";\n\nexport function capture(vaultPath: string, inboxFile: string, text: string): void {\n  // Expand ~ to home directory\n  const expandedVaultPath = vaultPath.replace(/^~/, process.env.HOME || \"\");\n  const inboxPath = path.join(expandedVaultPath, inboxFile);\n  const dir = path.dirname(inboxPath);\n\n  // Create parent directories if needed\n  if (!fs.existsSync(dir)) {\n    fs.mkdirSync(dir, { recursive: true });\n  }\n\n  // Append text with newline\n  fs.appendFileSync(inboxPath, `${text}\\n`);\n}\n"],
  "mappings": "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",
  "names": ["fs", "path", "fs", "path", "vaultPath"]
}
